# Rules
# This file contains the actual rule definitions
# Others can pull/extend this file

rules:
  # OWASP rules
  - organization: OWASP
    code: "001"
    rule_class: IOH
    name: LLM output executed without sanitization
    description: |
      Detects cases where LLM-generated content is passed directly to exec/eval/shell without validation.
      Patterns: exec(llm_output), os.system(llm_output), subprocess.run(llm_output) with no sanitization.
    severity: error
    enabled: true
    source:
      name: OWASP
      link: null

  - organization: OWASP
    code: "002"
    rule_class: IOH
    name: LLM output rendered to browser without encoding
    description: |
      Identifies when LLM output is inserted into web/JS/Markdown contexts without proper encoding/escaping.
      Patterns: innerHTML = llm_output, render_template(content=llm_output) with no escape.
    severity: warning
    enabled: true
    source:
      name: OWASP
      link: null

  - organization: OWASP
    code: "003"
    rule_class: IOH
    name: LLM output used in DB/file path without parameterization
    description: |
      Checks when LLM output is used directly to build SQL queries, file paths, or commands without safeguards.
      Patterns: query = f"…{llm_output}…", open(f"/tmp/{llm_output}"), db.execute(llm_output) without parameterization.
    severity: error
    enabled: true
    source:
      name: OWASP
      link: null

  # NEops rules
  - organization: NEops
    code: "001"
    rule_class: MP
    name: Model provider is listed as Worrying
    description: |
      Checks if the code or configuration uses a model provider flagged as Worrying in the provider list.
      Model provider invocation (e.g., model_provider = "DeepSeek") and that provider is in the "Worrying" list.
    severity: warning
    enabled: true
    source:
      name: Neops
      link: null

  - organization: NEops
    code: "002"
    rule_class: MP
    name: Model provider is listed as Dangerous
    description: |
      Checks if the code or configuration uses a model provider flagged as Dangerous in the provider list.
      Model provider invocation and that provider is in the "Dangerous" list.
    severity: error
    enabled: true
    source:
      name: Neops
      link: null

  # OpenAI rules
  - organization: OpenAI
    code: "001"
    rule_class: DM
    name: Deprecated model used
    description: |
      Checks if the model version in use has already been officially deprecated or removed.
      Model version used appears in provider's deprecated/retired list (e.g., retired model versions per OpenAI).
    severity: info
    enabled: true
    source:
      name: OpenAI
      link: https://platform.openai.com/docs/deprecations

  # Anthropic rules
  - organization: Anthropic
    code: "001"
    rule_class: DM
    name: Legacy model used
    description: |
      Checks if the model version in use is listed as legacy (scheduled for future deprecation).
      Model version used found on provider's legacy list with a future retirement date.
    severity: error
    enabled: true
    source:
      name: Anthropic
      link: null
